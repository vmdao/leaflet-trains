<!DOCTYPE html>
<html>

<head>
  <meta charset=utf-8 />
  <title>Enouvo Map</title>
  <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

  <!-- Load Leaflet -->
  <link rel="stylesheet" href="../node_modules/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="../dist/leaflet-trains.css" />
  <script src="../node_modules/leaflet/dist/leaflet-src.js"></script>

  <!-- Load Esri Leaflet from source-->
  <script src="../dist/leaflet-trains-debug.js"></script>

  <style>
    body {
      margin: 0;
      padding: 0;
    }

    #map {
      position: absolute;
      top: 0;
      bottom: 0;
      right: 0;
      left: 0;
    }

    #info-pane {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 1000;
      padding: 1em;
      background: white;
    }
  </style>
</head>

<body>

  <div id="map"></div>
  <script>
    var collections = [{
        properties: {
          Name: 'Glen Waverley Line',
          name: 'Glen Waverley Line',
          Id: 'DjFAIvCY',
          Stations: [{
              StationOrder: 1,
              Station: {
                Id: '0RTqfRsv',
                StationName: 'Flagstaff',
                Longitude: 144.955653,
                Latitude: -37.811978,
                CapitalZone: 19841,
                Address: 'William St / La Trobe St, Melbourne City 3000'
              }
            },
            {
              StationOrder: 2,
              Station: {
                Id: '2mTDiQUm',
                StationName: 'East Richmond',
                Longitude: 144.997068,
                Latitude: -37.826403,
                CapitalZone: 19907,
                Address: 'Church St / Adolph St, Richmond 3121'
              }
            },
            {
              StationOrder: 3,
              Station: {
                Id: '5dF9SqtW',
                StationName: 'Richmond ',
                Longitude: 144.990161,
                Latitude: -37.824072,
                CapitalZone: 19908,
                Address: 'Punt Rd / Swan St, Richmond 3121'
              }
            },
            {
              StationOrder: 4,
              Station: {
                Id: '9GC9IBHY',
                StationName: 'Holmesglen',
                Longitude: 145.090657,
                Latitude: -37.874401,
                CapitalZone: 19839,
                Address: 'Warrigal Rd, Malvern East 3145'
              }
            },
            {
              StationOrder: 5,
              Station: {
                Id: 'bat2i2Fo',
                StationName: 'Flinders Street',
                Longitude: 144.966967,
                Latitude: -37.818308,
                CapitalZone: 19854,
                Address: 'Flinders St, Melbourne City 3000'
              }
            },
            {
              StationOrder: 6,
              Station: {
                Id: 'bNTvc6C5',
                StationName: 'Kooyong',
                Longitude: 145.03355,
                Latitude: -37.839926,
                CapitalZone: 19910,
                Address: 'Glenferrie Rd / Monaro Rd, Kooyong 3144'
              }
            },
            {
              StationOrder: 7,
              Station: {
                Id: 'dAIPCKSe',
                StationName: 'Melbourne Central',
                Longitude: 144.962599,
                Latitude: -37.809936,
                CapitalZone: 19842,
                Address: 'La Trobe St, Melbourne City 3000'
              }
            },
            {
              StationOrder: 8,
              Station: {
                Id: 'eKubFRIx',
                StationName: 'Southern Cross',
                Longitude: 144.951409,
                Latitude: -37.817933,
                CapitalZone: 22180,
                Address: 'Collins St / Spencer St, Melbourne City 3000'
              }
            },
            {
              StationOrder: 9,
              Station: {
                Id: 'eytocOCR',
                StationName: 'Tooronga',
                Longitude: 145.042601,
                Latitude: -37.850663,
                CapitalZone: 13663,
                Address: 'Milton Pde / Tooronga Rd, Glen Iris 3146'
              }
            },
            {
              StationOrder: 10,
              Station: {
                Id: 'gAiwt8C9',
                StationName: 'East Malvern',
                Longitude: 145.069397,
                Latitude: -37.87693,
                CapitalZone: 19838,
                Address: 'Waverley Rd, Malvern East 3145'
              }
            },
            {
              StationOrder: 11,
              Station: {
                Id: 'gjios8Hy',
                StationName: 'Burnley',
                Longitude: 145.007553,
                Latitude: -37.827558,
                CapitalZone: 19906,
                Address: 'Burnley St / Madden Gr, Burnley 3121'
              }
            },
            {
              StationOrder: 12,
              Station: {
                Id: 'JBubf2F4',
                StationName: 'Gardiner',
                Longitude: 145.05166,
                Latitude: -37.853283,
                CapitalZone: 19912,
                Address: 'Burke Rd, Glen Iris 3146'
              }
            },
            {
              StationOrder: 13,
              Station: {
                Id: 'lpFAcdsq',
                StationName: 'Jordanville',
                Longitude: 145.112089,
                Latitude: -37.873599,
                CapitalZone: 19840,
                Address: 'Hillview Ave / Windsor Ave, Mount Waverley 3149'
              }
            },
            {
              StationOrder: 14,
              Station: {
                Id: 'lqCrHxtQ',
                StationName: 'Parliament ',
                Longitude: 144.972907,
                Latitude: -37.811055,
                CapitalZone: 19843,
                Address: 'Spring St, Melbourne City 3000'
              }
            },
            {
              StationOrder: 15,
              Station: {
                Id: 'nXcACysE',
                StationName: 'Syndal',
                Longitude: 145.149776,
                Latitude: -37.876228,
                CapitalZone: 19874,
                Address: 'Fiander Ave / Coleman Pde, Glen Waverley 3150'
              }
            },
            {
              StationOrder: 16,
              Station: {
                Id: 'o0udCbc4',
                StationName: 'Glen Waverley',
                Longitude: 145.162063,
                Latitude: -37.879502,
                CapitalZone: 19873,
                Address: 'Glendale St / Coleman Pde, Glen Waverley 3150'
              }
            },
            {
              StationOrder: 17,
              Station: {
                Id: 'PYtlFrHX',
                StationName: 'Mount Waverley',
                Longitude: 145.128057,
                Latitude: -37.875251,
                CapitalZone: 19875,
                Address: 'Stephensons Rd / Miller Cres, Mount Waverley 3149'
              }
            },
            {
              StationOrder: 18,
              Station: {
                Id: 'r6T6sMSp',
                StationName: 'Heyington',
                Longitude: 145.022633,
                Latitude: -37.83467,
                CapitalZone: 19909,
                Address: 'Gawith Ct / Heyington Pl, Toorak 3142'
              }
            },
            {
              StationOrder: 19,
              Station: {
                Id: 'zmc3HYIl',
                StationName: 'Darling',
                Longitude: 145.060746,
                Latitude: -37.870029,
                CapitalZone: 21999,
                Address: 'Malvern Rd / Darling Rd, Malvern East 3145'
              }
            },
            {
              StationOrder: 20,
              Station: {
                Id: 'ZZFPIrCd',
                StationName: 'Glen Iris',
                Longitude: 145.058223,
                Latitude: -37.859306,
                CapitalZone: 19835,
                Address: 'High St / Wills St, Glen Iris 3146'
              }
            }
          ]
        },

        paths: [
          [145.00725, -37.82754],
          [145.01027, -37.82787],
          [145.01127, -37.82795],
          [145.01231, -37.82789],
          [145.01397, -37.82773],
          [145.0153, -37.8277],
          [145.01728, -37.82777],
          [145.01802, -37.82793],
          [145.01853, -37.82809],
          [145.01905, -37.8283],
          [145.01942, -37.82857],
          [145.01965, -37.82886],
          [145.02, -37.82933],
          [145.02034, -37.82996],
          [145.02064, -37.83069],
          [145.02088, -37.8314],
          [145.02157, -37.83315],
          [145.02187, -37.83357],
          [145.02223, -37.83418],
          [145.0226, -37.83462],
          [145.02335, -37.83523],
          [145.02375, -37.83564],
          [145.02425, -37.83606],
          [145.02487, -37.83694],
          [145.02523, -37.83738],
          [145.02573, -37.83806],
          [145.02639, -37.83855],
          [145.02699, -37.83891],
          [145.02796, -37.83925],
          [145.02912, -37.83942],
          [145.03094, -37.83957],
          [145.03315, -37.83984],
          [145.03407, -37.84011],
          [145.03558, -37.84075],
          [145.03661, -37.84155],
          [145.03701, -37.84198],
          [145.03729, -37.84242],
          [145.03787, -37.84348],
          [145.03828, -37.84411],
          [145.03929, -37.84608],
          [145.03993, -37.84728],
          [145.04122, -37.84892],
          [145.04225, -37.84975],
          [145.04457, -37.85089],
          [145.04684, -37.85165],
          [145.04766, -37.85199],
          [145.04897, -37.85241],
          [145.05023, -37.8528],
          [145.053, -37.85378],
          [145.05362, -37.85409],
          [145.0542, -37.85445],
          [145.05465, -37.85483],
          [145.05635, -37.85688],
          [145.05706, -37.85787],
          [145.05768, -37.85863],
          [145.05845, -37.8598],
          [145.05955, -37.86207],
          [145.05976, -37.86271],
          [145.06057, -37.86537],
          [145.06096, -37.86644],
          [145.06214, -37.86808],
          [145.06326, -37.86932],
          [145.06407, -37.87034],
          [145.06442, -37.87096],
          [145.06538, -37.87313],
          [145.06564, -37.87386],
          [145.06605, -37.8745],
          [145.06641, -37.87498],
          [145.06675, -37.87535],
          [145.06729, -37.87578],
          [145.0679, -37.87622],
          [145.06843, -37.87654],
          [145.06952, -37.87701],
          [145.07015, -37.87722],
          [145.07072, -37.87738],
          [145.07139, -37.87749],
          [145.07204, -37.87751],
          [145.07252, -37.87748],
          [145.07494, -37.87727],
          [145.07752, -37.87713],
          [145.07845, -37.87706],
          [145.08112, -37.87677],
          [145.08455, -37.87596],
          [145.08979, -37.87465],
          [145.09264, -37.87421],
          [145.09675, -37.87385],
          [145.10858, -37.87302],
          [145.10919, -37.87303],
          [145.10956, -37.87305],
          [145.11042, -37.87319],
          [145.11187, -37.87353],
          [145.1123, -37.8737],
          [145.1143, -37.87437],
          [145.11508, -37.8746],
          [145.11584, -37.87478],
          [145.11727, -37.87498],
          [145.12017, -37.87521],
          [145.12447, -37.8753],
          [145.14041, -37.87523],
          [145.14763, -37.87612],
          [145.15234, -37.87675],
          [145.1627, -37.87962]
        ]
      },
      {
        properties: {
          Name: 'Hurstbridge Line',
          name: 'Hurstbridge Line',
          Id: 'J3T9u1H4',
          Stations: [{
              StationOrder: 1,
              Station: {
                Id: '0RTqfRsv',
                StationName: 'Flagstaff',
                Longitude: 144.955653,
                Latitude: -37.811978,
                CapitalZone: 19841,
                Address: 'William St / La Trobe St, Melbourne City 3000'
              }
            },
            {
              StationOrder: 2,
              Station: {
                Id: '27smCquG',
                StationName: 'Eltham',
                Longitude: 145.147827,
                Latitude: -37.713552,
                CapitalZone: 19987,
                Address: 'Pryor St / Main Rd, Eltham 3095'
              }
            },
            {
              StationOrder: 3,
              Station: {
                Id: '3QTNu2t9',
                StationName: 'Ivanhoe',
                Longitude: 145.045426,
                Latitude: -37.768898,
                CapitalZone: 19933,
                Address: 'Young St / Norman St, Ivanhoe 3079'
              }
            },
            {
              StationOrder: 4,
              Station: {
                Id: '6luKSGs0',
                StationName: 'Victoria Park',
                Longitude: 144.994447,
                Latitude: -37.799155,
                CapitalZone: 19975,
                Address: 'Johnston St / Lulie St, Abbotsford 3067'
              }
            },
            {
              StationOrder: 5,
              Station: {
                Id: '99I3sGUd',
                StationName: 'Collingwood Railway',
                Longitude: 144.993745,
                Latitude: -37.804523,
                CapitalZone: 19976,
                Address: 'Gipps St / Eddy Ct, Abbotsford 3067'
              }
            },
            {
              StationOrder: 6,
              Station: {
                Id: 'bat2i2Fo',
                StationName: 'Flinders Street',
                Longitude: 144.966967,
                Latitude: -37.818308,
                CapitalZone: 19854,
                Address: 'Flinders St, Melbourne City 3000'
              }
            },
            {
              StationOrder: 7,
              Station: {
                Id: 'BzuyiDcg',
                StationName: 'Westgarth',
                Longitude: 144.99987,
                Latitude: -37.78146,
                CapitalZone: 675,
                Address: 'Westgarth St, Northcote 3070'
              }
            },
            {
              StationOrder: 8,
              Station: {
                Id: 'dAIPCKSe',
                StationName: 'Melbourne Central',
                Longitude: 144.962599,
                Latitude: -37.809936,
                CapitalZone: 19842,
                Address: 'La Trobe St, Melbourne City 3000'
              }
            },
            {
              StationOrder: 9,
              Station: {
                Id: 'eKubFRIx',
                StationName: 'Southern Cross',
                Longitude: 144.951409,
                Latitude: -37.817933,
                CapitalZone: 22180,
                Address: 'Collins St / Spencer St, Melbourne City 3000'
              }
            },
            {
              StationOrder: 10,
              Station: {
                Id: 'EmF3cruw',
                StationName: 'Eaglemont',
                Longitude: 145.053946,
                Latitude: -37.763586,
                CapitalZone: 19934,
                Address: 'Silverdale Rd, Eaglemont 3084'
              }
            },
            {
              StationOrder: 11,
              Station: {
                Id: 'jjIrTvuN',
                StationName: 'Montmorency',
                Longitude: 145.121511,
                Latitude: -37.715297,
                CapitalZone: 19986,
                Address: 'Station Rd, Montmorency 3094'
              }
            },
            {
              StationOrder: 12,
              Station: {
                Id: 'jkSLURcZ',
                StationName: 'Greensborough',
                Longitude: 145.108249,
                Latitude: -37.70395,
                CapitalZone: 19985,
                Address: 'Poulter Ave, Greensborough 3088'
              }
            },
            {
              StationOrder: 13,
              Station: {
                Id: 'kPswirS5',
                StationName: 'Jolimont',
                Longitude: 144.984096,
                Latitude: -37.81653,
                CapitalZone: 19979,
                Address: 'Wellington Cres, East Melbourne 3002'
              }
            },
            {
              StationOrder: 14,
              Station: {
                Id: 'LgtQcpF6',
                StationName: 'West Richmond',
                Longitude: 144.991418,
                Latitude: -37.814945,
                CapitalZone: 19978,
                Address: 'Freeman St / Muir St, Richmond 3121'
              }
            },
            {
              StationOrder: 15,
              Station: {
                Id: 'lqCrHxtQ',
                StationName: 'Parliament ',
                Longitude: 144.972907,
                Latitude: -37.811055,
                CapitalZone: 19843,
                Address: 'Spring St, Melbourne City 3000'
              }
            },
            {
              StationOrder: 16,
              Station: {
                Id: 'M5u0FEHL',
                StationName: 'Wattle Glen',
                Longitude: 145.181619,
                Latitude: -37.663966,
                CapitalZone: 19989,
                Address: 'Heidelberg-Kinglake Rd, Wattle Glen 3096'
              }
            },
            {
              StationOrder: 17,
              Station: {
                Id: 'O4TlcwhG',
                StationName: 'Dennis',
                Longitude: 145.00824,
                Latitude: -37.779183,
                CapitalZone: 19929,
                Address: 'Cain Ave, Northcote 3070'
              }
            },
            {
              StationOrder: 18,
              Station: {
                Id: 'oDUlszIo',
                StationName: 'Clifton Hill',
                Longitude: 144.995417,
                Latitude: -37.788654,
                CapitalZone: 19974,
                Address: 'Heidelberg Rd / John St, Clifton Hill 3068'
              }
            },
            {
              StationOrder: 19,
              Station: {
                Id: 'pnC6fXHY',
                StationName: 'Macleod',
                Longitude: 145.069147,
                Latitude: -37.72601,
                CapitalZone: 19983,
                Address: 'Birdwood Ave, Macleod 3085'
              }
            },
            {
              StationOrder: 20,
              Station: {
                Id: 'qLIOCYtE',
                StationName: 'North Richmond',
                Longitude: 144.9925,
                Latitude: -37.810396,
                CapitalZone: 19977,
                Address: 'Victoria St / Regent St, Richmond 3121'
              }
            },
            {
              StationOrder: 21,
              Station: {
                Id: 'RpsBIotJ',
                StationName: 'Darebin',
                Longitude: 145.038476,
                Latitude: -37.774962,
                CapitalZone: 19932,
                Address: 'Merton St / Heidelberg Rd, Ivanhoe 3079'
              }
            },
            {
              StationOrder: 22,
              Station: {
                Id: 'rWSkT0s2',
                StationName: 'Alphington',
                Longitude: 145.031251,
                Latitude: -37.778396,
                CapitalZone: 19931,
                Address: 'Miller St / Rowe St, Alphington 3078'
              }
            },
            {
              StationOrder: 23,
              Station: {
                Id: 'rwUKs5HK',
                StationName: 'Watsonia',
                Longitude: 145.083795,
                Latitude: -37.710954,
                CapitalZone: 19984,
                Address: 'Greensborough Rd, Watsonia 3087'
              }
            },
            {
              StationOrder: 24,
              Station: {
                Id: 'WBcKf3HV',
                StationName: 'Fairfield',
                Longitude: 145.016903,
                Latitude: -37.779174,
                CapitalZone: 19930,
                Address: 'Gillies St / Railway Pl, Fairfield 3078'
              }
            },
            {
              StationOrder: 25,
              Station: {
                Id: 'WQFGiBC4',
                StationName: 'Hurstbridge',
                Longitude: 145.192012,
                Latitude: -37.639402,
                CapitalZone: 19990,
                Address: 'Heidelberg-Kinglake Rd, Hurstbridge 3099'
              }
            },
            {
              StationOrder: 26,
              Station: {
                Id: 'X1tNsBCK',
                StationName: 'Diamond Creek',
                Longitude: 145.158509,
                Latitude: -37.673293,
                CapitalZone: 19988,
                Address: 'Station St, Diamond Creek 3089'
              }
            },
            {
              StationOrder: 27,
              Station: {
                Id: 'x5TjuWse',
                StationName: 'Heidelberg',
                Longitude: 145.06069,
                Latitude: -37.757075,
                CapitalZone: 19935,
                Address: 'Studley Rd, Heidelberg 3084'
              }
            },
            {
              StationOrder: 28,
              Station: {
                Id: 'z5i7HvI0',
                StationName: 'Rosanna',
                Longitude: 145.06614,
                Latitude: -37.742875,
                CapitalZone: 19936,
                Address: 'Douglas St / Station Rd, Rosanna 3084'
              }
            }
          ]
        },
        paths: [
          [144.99576, -37.78653],
          [144.9961, -37.78583],
          [144.99748, -37.78359],
          [144.99847, -37.78185],
          [144.99907, -37.7809],
          [144.99981, -37.78008],
          [145.00045, -37.77968],
          [145.00121, -37.77938],
          [145.00251, -37.77921],
          [145.00387, -37.77917],
          [145.01682, -37.77919],
          [145.02422, -37.77917],
          [145.02687, -37.77915],
          [145.0285, -37.77908],
          [145.02944, -37.77895],
          [145.03146, -37.77835],
          [145.03626, -37.77677],
          [145.03682, -37.7765],
          [145.03762, -37.77598],
          [145.03837, -37.77513],
          [145.04253, -37.7703],
          [145.04328, -37.7698],
          [145.04412, -37.7694],
          [145.04789, -37.76797],
          [145.04987, -37.7665],
          [145.05201, -37.76507],
          [145.05294, -37.76436],
          [145.05459, -37.76314],
          [145.05549, -37.76225],
          [145.05618, -37.76139],
          [145.05712, -37.76025],
          [145.05779, -37.75959],
          [145.05987, -37.75791],
          [145.06182, -37.75645],
          [145.06324, -37.75533],
          [145.06497, -37.75401],
          [145.0657, -37.75337],
          [145.06605, -37.75282],
          [145.06639, -37.75204],
          [145.06658, -37.75114],
          [145.06667, -37.7499],
          [145.06693, -37.74722],
          [145.06697, -37.74632],
          [145.06628, -37.74361],
          [145.06579, -37.7413],
          [145.06545, -37.73801],
          [145.06551, -37.73682],
          [145.06568, -37.73584],
          [145.06742, -37.73192],
          [145.06817, -37.73005],
          [145.06886, -37.72801],
          [145.06897, -37.72659],
          [145.06912, -37.72574],
          [145.06935, -37.7246],
          [145.06952, -37.7236],
          [145.06997, -37.72248],
          [145.07051, -37.72172],
          [145.07113, -37.72101],
          [145.0721, -37.72041],
          [145.07392, -37.71953],
          [145.07579, -37.71853],
          [145.07669, -37.71778],
          [145.07723, -37.71717],
          [145.07828, -37.71588],
          [145.07881, -37.71527],
          [145.07942, -37.71481],
          [145.08051, -37.7142],
          [145.08148, -37.71333],
          [145.0821, -37.71281],
          [145.08517, -37.7096],
          [145.08856, -37.70671],
          [145.08907, -37.70607],
          [145.09066, -37.70359],
          [145.09162, -37.7023],
          [145.09401, -37.70009],
          [145.09478, -37.69957],
          [145.09547, -37.69919],
          [145.09609, -37.69904],
          [145.09699, -37.69889],
          [145.09789, -37.69897],
          [145.09881, -37.69921],
          [145.09963, -37.6996],
          [145.10175, -37.70016],
          [145.10222, -37.70038],
          [145.103, -37.7008],
          [145.10379, -37.70135],
          [145.10456, -37.70182],
          [145.10525, -37.70215],
          [145.10581, -37.70237],
          [145.10643, -37.70265],
          [145.10722, -37.70316],
          [145.10763, -37.70354],
          [145.10847, -37.7044],
          [145.10892, -37.70498],
          [145.10926, -37.70547],
          [145.10984, -37.70622],
          [145.11027, -37.70683],
          [145.11094, -37.70736],
          [145.11182, -37.70824],
          [145.11257, -37.70889],
          [145.11323, -37.70963],
          [145.11493, -37.71181],
          [145.11647, -37.71362],
          [145.11679, -37.71396],
          [145.11722, -37.71425],
          [145.1177, -37.7145],
          [145.11823, -37.71474],
          [145.11898, -37.71496],
          [145.1204, -37.7151],
          [145.12119, -37.71525],
          [145.12203, -37.71545],
          [145.12521, -37.71646],
          [145.12596, -37.71664],
          [145.12679, -37.71681],
          [145.12769, -37.71685],
          [145.1295, -37.71669],
          [145.13029, -37.71642],
          [145.13124, -37.71617],
          [145.13411, -37.71472],
          [145.1351, -37.71456],
          [145.136, -37.71459],
          [145.13681, -37.71476],
          [145.13752, -37.71513],
          [145.13823, -37.71561],
          [145.13965, -37.71644],
          [145.14061, -37.71671],
          [145.14166, -37.71674],
          [145.14269, -37.71656],
          [145.14458, -37.71613],
          [145.14546, -37.7159],
          [145.14626, -37.71547],
          [145.14681, -37.71481],
          [145.14819, -37.71257],
          [145.14855, -37.71187],
          [145.1487, -37.71128],
          [145.14874, -37.7097],
          [145.14872, -37.7087],
          [145.14879, -37.70765],
          [145.14913, -37.70702],
          [145.1496, -37.70651],
          [145.15031, -37.70598],
          [145.15171, -37.7049],
          [145.15441, -37.70299],
          [145.15495, -37.70225],
          [145.15525, -37.70121],
          [145.15527, -37.70074],
          [145.15499, -37.69965],
          [145.15456, -37.69907],
          [145.15297, -37.69737],
          [145.15259, -37.69681],
          [145.15239, -37.69629],
          [145.15239, -37.69566],
          [145.15263, -37.69496],
          [145.15398, -37.69282],
          [145.156, -37.68922],
          [145.15632, -37.68844],
          [145.15634, -37.68751],
          [145.15628, -37.68656],
          [145.15613, -37.68576],
          [145.15585, -37.68532],
          [145.15533, -37.68481],
          [145.15387, -37.68349],
          [145.15276, -37.68253],
          [145.15205, -37.68148],
          [145.15173, -37.68067],
          [145.15155, -37.68004],
          [145.15164, -37.679],
          [145.15192, -37.67829],
          [145.15229, -37.67768],
          [145.1528, -37.6771],
          [145.15344, -37.67661],
          [145.15394, -37.67611],
          [145.15482, -37.67535],
          [145.15555, -37.67481],
          [145.15621, -37.67442],
          [145.15728, -37.67384],
          [145.15816, -37.6735],
          [145.15915, -37.67323],
          [145.1601, -37.67306],
          [145.16104, -37.67292],
          [145.16327, -37.67275],
          [145.16411, -37.6726],
          [145.16542, -37.67212],
          [145.16634, -37.67151],
          [145.16707, -37.67107],
          [145.16771, -37.67076],
          [145.16879, -37.67041],
          [145.16992, -37.67007],
          [145.17089, -37.66983],
          [145.17278, -37.66925],
          [145.17422, -37.66881],
          [145.17565, -37.66834],
          [145.17808, -37.66766],
          [145.179, -37.6672],
          [145.1796, -37.66679],
          [145.18046, -37.66635],
          [145.18082, -37.66601],
          [145.18145, -37.66472],
          [145.18168, -37.66397],
          [145.18228, -37.66226],
          [145.18252, -37.66151],
          [145.18276, -37.66091],
          [145.18306, -37.66032],
          [145.1837, -37.65976],
          [145.18458, -37.65927],
          [145.18527, -37.65877],
          [145.1858, -37.65825],
          [145.18653, -37.65724],
          [145.18718, -37.65599],
          [145.18853, -37.65295],
          [145.18902, -37.65137],
          [145.18928, -37.65043],
          [145.18909, -37.6497],
          [145.18911, -37.64882],
          [145.18941, -37.64817],
          [145.18945, -37.64748],
          [145.18936, -37.64674],
          [145.18934, -37.64608],
          [145.18949, -37.64537],
          [145.1902, -37.6443],
          [145.19048, -37.64358],
          [145.19048, -37.64297],
          [145.19035, -37.64224],
          [145.19037, -37.64151],
          [145.19057, -37.64088],
          [145.19112, -37.6402],
          [145.19155, -37.63978]
        ]
      },
      {
        properties: {
          Name: 'Alamein Line',
          name: 'Alamein Line',
          Id: 'OjtDTgF5',
          Stations: [{
              StationOrder: 1,
              Station: {
                Id: '0RTqfRsv',
                StationName: 'Flagstaff',
                Longitude: 144.955653,
                Latitude: -37.811978,
                CapitalZone: 19841,
                Address: 'William St / La Trobe St, Melbourne City 3000'
              }
            },
            {
              StationOrder: 2,
              Station: {
                Id: '2mTDiQUm',
                StationName: 'East Richmond',
                Longitude: 144.997068,
                Latitude: -37.826403,
                CapitalZone: 19907,
                Address: 'Church St / Adolph St, Richmond 3121'
              }
            },
            {
              StationOrder: 3,
              Station: {
                Id: '5dF9SqtW',
                StationName: 'Richmond ',
                Longitude: 144.990161,
                Latitude: -37.824072,
                CapitalZone: 19908,
                Address: 'Punt Rd / Swan St, Richmond 3121'
              }
            },
            {
              StationOrder: 4,
              Station: {
                Id: '5wugf6Ir',
                StationName: 'Willison',
                Longitude: 145.070298,
                Latitude: -37.835712,
                CapitalZone: 19851,
                Address: 'Shalless Dr, Camberwell 3124'
              }
            },
            {
              StationOrder: 5,
              Station: {
                Id: 'ADHysNhK',
                StationName: 'Hawthorn',
                Longitude: 145.022897,
                Latitude: -37.821824,
                CapitalZone: 19905,
                Address: 'Burwood Rd / Evansdale Rd, Hawthorn 3122'
              }
            },
            {
              StationOrder: 6,
              Station: {
                Id: 'bat2i2Fo',
                StationName: 'Flinders Street',
                Longitude: 144.966967,
                Latitude: -37.818308,
                CapitalZone: 19854,
                Address: 'Flinders St, Melbourne City 3000'
              }
            },
            {
              StationOrder: 7,
              Station: {
                Id: 'bBu3fRHq',
                StationName: 'Burwood',
                Longitude: 145.080508,
                Latitude: -37.851561,
                CapitalZone: 19849,
                Address: 'Maverston St / Bardolph St, Glen Iris 3146'
              }
            },
            {
              StationOrder: 8,
              Station: {
                Id: 'dAIPCKSe',
                StationName: 'Melbourne Central',
                Longitude: 144.962599,
                Latitude: -37.809936,
                CapitalZone: 19842,
                Address: 'La Trobe St, Melbourne City 3000'
              }
            },
            {
              StationOrder: 9,
              Station: {
                Id: 'Dnc3ivTN',
                StationName: 'Ashburton',
                Longitude: 145.081341,
                Latitude: -37.861968,
                CapitalZone: 19848,
                Address: 'Fakenham Rd / Welfare Pde, Ashburton 3147'
              }
            },
            {
              StationOrder: 10,
              Station: {
                Id: 'eJivUQhL',
                StationName: 'Hartwell',
                Longitude: 145.075561,
                Latitude: -37.843984,
                CapitalZone: 19850,
                Address: 'Tyrone St / Georgina Pde, Camberwell 3124'
              }
            },
            {
              StationOrder: 11,
              Station: {
                Id: 'eKubFRIx',
                StationName: 'Southern Cross',
                Longitude: 144.951409,
                Latitude: -37.817933,
                CapitalZone: 22180,
                Address: 'Collins St / Spencer St, Melbourne City 3000'
              }
            },
            {
              StationOrder: 12,
              Station: {
                Id: 'gjios8Hy',
                StationName: 'Burnley',
                Longitude: 145.007553,
                Latitude: -37.827558,
                CapitalZone: 19906,
                Address: 'Burnley St / Madden Gr, Burnley 3121'
              }
            },
            {
              StationOrder: 13,
              Station: {
                Id: 'jrCWs3hK',
                StationName: 'Alamein',
                Longitude: 145.079659,
                Latitude: -37.868317,
                CapitalZone: 19847,
                Address: 'Alamein Ave / Ashburn Gr, Ashburton 3147'
              }
            },
            {
              StationOrder: 14,
              Station: {
                Id: 'lqCrHxtQ',
                StationName: 'Parliament ',
                Longitude: 144.972907,
                Latitude: -37.811055,
                CapitalZone: 19843,
                Address: 'Spring St, Melbourne City 3000'
              }
            },
            {
              StationOrder: 15,
              Station: {
                Id: 'LyCKFatQ',
                StationName: 'Auburn',
                Longitude: 145.045197,
                Latitude: -37.822068,
                CapitalZone: 21238,
                Address: 'Victoria St / Auburn Rd, Hawthorn East 3123'
              }
            },
            {
              StationOrder: 16,
              Station: {
                Id: 'MxT5t9fa',
                StationName: 'Riversdale',
                Longitude: 145.069648,
                Latitude: -37.831502,
                CapitalZone: 19852,
                Address: 'Wandin Rd, Camberwell 3124'
              }
            },
            {
              StationOrder: 17,
              Station: {
                Id: 'QpSXtPfY',
                StationName: 'Camberwell',
                Longitude: 145.058692,
                Latitude: -37.826564,
                CapitalZone: 19853,
                Address: 'Burke Rd / Cookson St, Camberwell 3124'
              }
            },
            {
              StationOrder: 18,
              Station: {
                Id: 'z4HofmS8',
                StationName: 'Glenferrie',
                Longitude: 145.036438,
                Latitude: -37.821466,
                CapitalZone: 19904,
                Address: 'Glenferrie Rd, Hawthorn 3122'
              }
            }
          ]
        },
        paths: [
          [145.0589, -37.82665],
          [145.05994, -37.82661],
          [145.06329, -37.82643],
          [145.06519, -37.82637],
          [145.06686, -37.82613],
          [145.06744, -37.82608],
          [145.06776, -37.82611],
          [145.06829, -37.82622],
          [145.0688, -37.82642],
          [145.06905, -37.82656],
          [145.06935, -37.82676],
          [145.06964, -37.82706],
          [145.06981, -37.82732],
          [145.06994, -37.82758],
          [145.07003, -37.82785],
          [145.07008, -37.8282],
          [145.07007, -37.82855],
          [145.06989, -37.82974],
          [145.06974, -37.83092],
          [145.06964, -37.83147],
          [145.06931, -37.83348],
          [145.06935, -37.83388],
          [145.06946, -37.83422],
          [145.06958, -37.83453],
          [145.06973, -37.83481],
          [145.07539, -37.84374],
          [145.08057, -37.85157],
          [145.08167, -37.85337],
          [145.08246, -37.85463],
          [145.08276, -37.85522],
          [145.08297, -37.85583],
          [145.08308, -37.85648],
          [145.08311, -37.85738],
          [145.08302, -37.85788],
          [145.08286, -37.85834],
          [145.08207, -37.86018],
          [145.08098, -37.86288],
          [145.08035, -37.86435],
          [145.07967, -37.86832]
        ]
      }
    ];

    var trainsCollection = {
      "type": "FeatureCollection",
      "features": [{
        "type": "Feature",
        "id": "wzhDHzF3",
        "geometry": {
          "type": "Point",
          "coordinates": [145.079759, -37.83592]
        },
        "properties": {
          "type": "TRAIN",
          "id": "wzhDHzF3",
          "Segment": {
            "Id": "4ltPixCp",
            "SegmentOrder": 1,
            "StopAtDestinationStation": true,
            "DepartureStation": {
              "Id": "jrCWs3hK",
              "StationName": "Alamein", // [145.06974, -37.83092],
              "Longitude": 145.06974,
              "Latitude": -37.83092,
              "CapitalZone": 19847,
              "Address": "Alamein Ave / Ashburn Gr, Ashburton 3147"
            },
            "ArrivalStation": {
              "Id": "Dnc3ivTN",
              "StationName": "Ashburton",
              "Longitude": 145.081341,
              "Latitude": -37.861968,
              "CapitalZone": 19848,
              "Address": "Fakenham Rd / Welfare Pde, Ashburton 3147"
            },
            "Route": {
              "Id": "yBS5iVIy",
              "Name": "Alamein To City",
              "Line": {
                "Id": "OjtDTgF5",
                "Name": "Alamein Line"
              }
            }
          },
          "Id": "wzhDHzF3",
          "Coupled": false,
          "LastReport": "2018-10-09T05:00:00",
          "DestinationStation": null,
          "LastStation": null,
          "NextStation": null,
          "TrainNo": "M003",
          "Longitude": 145.079659,
          "Latitude": -37.868317,
          "UpdateAt": "2018-10-09T05:00:00"
        }
      }, {
        "type": "Feature",
        "id": "WEFrfoso",
        "geometry": {
          "type": "Point",
          "coordinates": [144.966967, -37.818308]
        },
        "properties": {
          "type": "TRAIN",
          "id": "WEFrfoso",
          "Segment": {
            "Id": "Mpt1FDsM",
            "SegmentOrder": 1,
            "StopAtDestinationStation": true,
            "DepartureStation": {
              "Id": "bat2i2Fo",
              "StationName": "Flinders Street",
              "Longitude": 144.966967,
              "Latitude": -37.818308,
              "CapitalZone": 19854,
              "Address": "Flinders St, Melbourne City 3000"
            },
            "ArrivalStation": {
              "Id": "5dF9SqtW",
              "StationName": "Richmond ",
              "Longitude": 144.990161,
              "Latitude": -37.824072,
              "CapitalZone": 19908,
              "Address": "Punt Rd / Swan St, Richmond 3121"
            },
            "Route": {
              "Id": "xocOiXtj",
              "Name": "To Alamein",
              "Line": {
                "Id": "OjtDTgF5",
                "Name": "Alamein Line"
              }
            }
          },
          "Id": "WEFrfoso",
          "Coupled": false,
          "LastReport": "2018-10-09T05:00:00",
          "DestinationStation": null,
          "LastStation": null,
          "NextStation": null,
          "TrainNo": "M001",
          "Longitude": 144.966967,
          "Latitude": -37.818308,
          "UpdateAt": "2018-10-09T05:00:00"
        }
      }, {
        "type": "Feature",
        "id": "6oINinuo",
        "geometry": {
          "type": "Point",
          "coordinates": [145.058692, -37.826564]
        },
        "properties": {
          "type": "TRAIN",
          "id": "6oINinuo",
          "Segment": {
            "Id": "ryi2S4Cl",
            "SegmentOrder": 8,
            "StopAtDestinationStation": true,
            "DepartureStation": {
              "Id": "QpSXtPfY",
              "StationName": "Camberwell",
              "Longitude": 145.058692,
              "Latitude": -37.826564,
              "CapitalZone": 19853,
              "Address": "Burke Rd / Cookson St, Camberwell 3124"
            },
            "ArrivalStation": {
              "Id": "MxT5t9fa",
              "StationName": "Riversdale",
              "Longitude": 145.069648,
              "Latitude": -37.831502,
              "CapitalZone": 19852,
              "Address": "Wandin Rd, Camberwell 3124"
            },
            "Route": {
              "Id": "xocOiXtj",
              "Name": "To Alamein",
              "Line": {
                "Id": "OjtDTgF5",
                "Name": "Alamein Line"
              }
            }
          },
          "Id": "6oINinuo",
          "Coupled": false,
          "LastReport": "2018-10-09T05:00:00",
          "DestinationStation": null,
          "LastStation": null,
          "NextStation": null,
          "TrainNo": "M002",
          "Longitude": 145.0589,
          "Latitude": -37.82655,
          "UpdateAt": "2018-10-09T05:00:00"
        }
      }, {
        "type": "Feature",
        "id": "eOSgTbsG",
        "geometry": {
          "type": "Point",
          "coordinates": [144.955653, -37.811978]
        },
        "properties": {
          "type": "TRAIN",
          "id": "eOSgTbsG",
          "Segment": {
            "Id": "AMHLSOcZ",
            "SegmentOrder": 16,
            "StopAtDestinationStation": true,
            "DepartureStation": {
              "Id": "0RTqfRsv",
              "StationName": "Flagstaff",
              "Longitude": 144.955653,
              "Latitude": -37.811978,
              "CapitalZone": 19841,
              "Address": "William St / La Trobe St, Melbourne City 3000"
            },
            "ArrivalStation": {
              "Id": "eKubFRIx",
              "StationName": "Southern Cross",
              "Longitude": 144.951409,
              "Latitude": -37.817933,
              "CapitalZone": 22180,
              "Address": "Collins St / Spencer St, Melbourne City 3000"
            },
            "Route": {
              "Id": "yBS5iVIy",
              "Name": "Alamein To City",
              "Line": {
                "Id": "OjtDTgF5",
                "Name": "Alamein Line"
              }
            }
          },
          "Id": "eOSgTbsG",
          "Coupled": false,
          "LastReport": "2018-10-09T05:00:00",
          "DestinationStation": null,
          "LastStation": null,
          "NextStation": null,
          "TrainNo": "M005",
          "Longitude": 144.955653,
          "Latitude": -37.811978,
          "UpdateAt": "2018-10-09T05:00:00"
        }
      }, {
        "type": "Feature",
        "id": "9oIdUKHA",
        "geometry": {
          "type": "Point",
          "coordinates": [145.022897, -37.821824]
        },
        "properties": {
          "type": "TRAIN",
          "id": "9oIdUKHA",
          "Segment": {
            "Id": "51u5cDUp",
            "SegmentOrder": 10,
            "StopAtDestinationStation": true,
            "DepartureStation": {
              "Id": "ADHysNhK",
              "StationName": "Hawthorn",
              "Longitude": 145.022897,
              "Latitude": -37.821824,
              "CapitalZone": 19905,
              "Address": "Burwood Rd / Evansdale Rd, Hawthorn 3122"
            },
            "ArrivalStation": {
              "Id": "gjios8Hy",
              "StationName": "Burnley",
              "Longitude": 145.007553,
              "Latitude": -37.827558,
              "CapitalZone": 19906,
              "Address": "Burnley St / Madden Gr, Burnley 3121"
            },
            "Route": {
              "Id": "yBS5iVIy",
              "Name": "Alamein To City",
              "Line": {
                "Id": "OjtDTgF5",
                "Name": "Alamein Line"
              }
            }
          },
          "Id": "9oIdUKHA",
          "Coupled": false,
          "LastReport": "2018-10-09T05:00:00",
          "DestinationStation": null,
          "LastStation": null,
          "NextStation": null,
          "TrainNo": "M004",
          "Longitude": 145.022897,
          "Latitude": -37.821824,
          "UpdateAt": "2018-10-09T05:00:00"
        }
      }]
    };

    function onListenerSelected(event) {
      console.log(event);
      const train = event.originEvent.target;
      const trainLocation = train.getLatLng();
      const layers = map.networkMaps.getLayers();

      const layer10 = layers[30];
      layers.forEach((l, index) => {
        if (l.setStyle && index !== 30) {
          l.setStyle({
            opacity: 0
          })
        }
      });

      const paths = layer10.getLatLngs();
      const pathsLength = paths.length;
      const closest = paths.reduce((current, next, index) => {
        const distance = next.distanceTo(trainLocation);
        if (distance > current.distance) {
          return current;
        }
        return {
          distance: distance,
          path: next,
          index: index
        };
      }, {
        distance: Infinity,
        path: null,
        index: 0
      });

      const closest2 = paths[closest.index + 1] || trainLocation;
      const point1 = closest.path;
      const point2 = closest2;
      const direction = L.enouvo.Util.getDirectionPoints(map_, [trainLocation, point1]);
      const angle = L.enouvo.Util.computeSegmentHeading(direction[0], direction[1]);
      console.log('angle', angle);

    }
    var map = L.enouvo.enouvoTrainInit('map');
    var map_ = map._map;
    map.setView([-37.81224, 144.97412], 15);
    map.setNetworkMaps(collections);
    map.addListeners([{
      event: 'click',
      action: onListenerSelected
    }]);
    map.setNetworkTrains(trainsCollection);
  </script>

</body>

</html>